<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ict.teamProject.comm.CommMapper">
	<select id="findAllMatesById" resultType="MateDto" parameterType="String">
		SELECT * FROM MATE_LIST WHERE ID = #{id}
	</select>
	<select id="findAllFriendsById" resultType="FriendDto" parameterType="String">
		SELECT * FROM FRIEND_LIST WHERE ID = #{id} and friend_blocking='N'
	</select>
	<select id="findAllSubToById" resultType="SubscribeToDto" parameterType="String">
		SELECT * FROM SUBSCRIBE_LIST WHERE ID = #{id}
	</select>
	<select id="findAllMySubById" resultType="MySubscriberDto" parameterType="String">
		SELECT * FROM SUBSCRIBE_LIST WHERE SUBSCRIBE_ID = #{id}
	</select>
	<select id="findNameById" resultType="String" parameterType="String">
		SELECT name from member where id = #{id}
	</select>
	<select id="findFnumById" resultType="Integer" parameterType="String">
		SELECT COUNT(*) FROM FRIEND_LIST WHERE ID = #{id}
	</select>
	<select id="findMnumById" resultType="Integer" parameterType="String">
		SELECT COUNT(*) FROM MATE_LIST WHERE ID = #{id}
	</select>
	<select id="findSnumById" resultType="Integer" parameterType="String">
		SELECT COUNT(*) FROM SUBSCRIBE_LIST WHERE SUBSCRIBE_ID = #{id}
	</select>
	<select id="findProPathById" resultType="String" parameterType="String">
		SELECT pro_filepath from profile WHERE ID = #{id}
	</select>
	<update id="putFavorableRating" parameterType="MateDto">
		UPDATE MATE_LIST SET FAVORABLE_RATING = #{favorable_rating}
		WHERE MATE_ID = #{mate_id}
	</update>
	<select id="findIntroductionById" parameterType="String" resultType="String">
		SELECT PRO_INTRODUCTION FROM PROFILE
		WHERE ID = #{id}
	</select>
	<select id="findJoinDateById" parameterType="String" resultType="java.sql.Date">
		SELECT REGIDATE FROM member
		WHERE ID = #{id}
	</select>
	<update id="putFriendBlocking" parameterType="Map">
		UPDATE FRIEND_LIST SET FRIEND_BLOCKING = 'Y' WHERE FRIEND_ID = #{id} and ID = #{userId}
	</update>
	<delete id="deleteFriend" parameterType="String">
		DELETE FROM add_friendmatelist 
		WHERE afml_id = #{id} and id = #{userId} and afml_yn='Y' and
	</delete>
	<delete id="deleteSubTo" parameterType="Map">
		DELETE FROM subscribe_list WHERE SUBSCRIBE_ID = #{subToId} and ID = #{userId}
	</delete>
	<delete id="deleteMate" parameterType="Map">
		DELETE FROM mate_list WHERE MATE_ID IN (#{id}, #{userId}) and ID IN (#{id}, #{userId})
	</delete>
	<delete id="deleteSubscriber" parameterType="Map">
		DELETE FROM subscribe_list WHERE ID = #{subId} AND SUBSCRIBE_ID = #{userId}
	</delete>
	<update id="putProfileImage" parameterType="UserProfileDto">
		UPDATE PROFILE SET PRO_FILEPATH = #{profilePath}
		WHERE id = #{id}
	</update>
	<insert id="updateSubscribe" parameterType="Map">
		INSERT INTO SUBSCRIBE_LIST VALUES(#{userId}, #{subToId}, default)
	</insert>
	<insert id="postFriendORMateRequest" parameterType="Map">
		INSERT INTO ADD_FRIENDMATELIST(ID, AFML_TYPE, AFML_ID, AFML_YN) VALUES(#{userId},#{type}, #{reqId},'W')
	</insert>
</mapper>